{
  "version": "1",
  "metadata": {
    "marimo_version": "0.19.7"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "060d89838417ddec2063aa5d4b42cac0",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "zgQs",
      "code_hash": "45ac7fe143051e951cf9cf4f46b94609",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "TVNx",
      "code_hash": "84312feb4ab2e8cb0615fa40109d3074",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r  0%|                                                    | 0/12 [00:00<?, ?it/s]\r  8%|\u2588\u2588\u2588\u258b                                        | 1/12 [00:00<00:04,  2.65it/s]\r 17%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                    | 2/12 [00:00<00:02,  3.42it/s]\r 25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                 | 3/12 [00:00<00:02,  4.17it/s]\r 33%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                             | 4/12 [00:00<00:01,  4.48it/s]\r 42%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                         | 5/12 [00:01<00:01,  4.47it/s]\r 50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                      | 6/12 [00:01<00:01,  4.30it/s]\r 58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                  | 7/12 [00:01<00:01,  4.49it/s]\r 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e              | 8/12 [00:01<00:00,  4.61it/s]\r 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588           | 9/12 [00:02<00:00,  4.45it/s]\r 83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a       | 10/12 [00:02<00:00,  4.44it/s]\r 92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 11/12 [00:02<00:00,  4.65it/s]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 12/12 [00:02<00:00,  4.84it/s]\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 12/12 [00:02<00:00,  4.42it/s]\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "saVe",
      "code_hash": "c1e85b954435b73d1d8e817cb3009fdc",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "JNSx",
      "code_hash": "fdd891fb5b0ca1c985a7c3aca6d9de25",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "yGih",
      "code_hash": "2af50ae729e4374bd21769f25af1ebd0",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "DHyH",
      "code_hash": "5faee44e637895cfea9e770498001d2b",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Accuracy Train: 0.88\nAccuracy Test: 0.64\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "HrMG",
      "code_hash": "e771fb5005f7673ecba6dfcf106a9b59",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJgJ",
      "code_hash": "5eb87ce85194176135f91ef8468656b1",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre class='text-xs'>&lt;stepwise_feature_selection.LGBMStepwiseFeatureSelector object at 0x160b30770&gt;</pre>"
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "Converting numpy array to DataFrame with default feature names\nStarting stepwise feature selection with 334 features\nImportance method: shap\nCross-validation folds: 5\n================================================================================\n\nStep 1: Evaluating 334 features\n  Mean CV Accuracy: 0.6401 (+/- 0.0086)\n  *** New best score! ***\n  Removing 33 least important features: ['feature_17', 'feature_132', 'feature_3', 'feature_133', 'feature_13', 'feature_175', 'feature_188', 'feature_1', 'feature_291', 'feature_290', 'feature_30', 'feature_14', 'feature_12', 'feature_27', 'feature_182', 'feature_9', 'feature_24', 'feature_21', 'feature_200', 'feature_18', 'feature_196', 'feature_7', 'feature_67', 'feature_92', 'feature_241', 'feature_211', 'feature_202', 'feature_214', 'feature_177', 'feature_296', 'feature_194', 'feature_22', 'feature_46']\n\nStep 2: Evaluating 301 features\n  Mean CV Accuracy: 0.6423 (+/- 0.0125)\n  *** New best score! ***\n  Removing 30 least important features: ['feature_231', 'feature_41', 'feature_37', 'feature_52', 'feature_327', 'feature_183', 'feature_178', 'feature_207', 'feature_2', 'feature_6', 'feature_221', 'feature_26', 'feature_70', 'feature_228', 'feature_206', 'feature_31', 'feature_227', 'feature_197', 'feature_53', 'feature_49', 'feature_208', 'feature_20', 'feature_220', 'feature_36', 'feature_101', 'feature_193', 'feature_295', 'feature_138', 'feature_56', 'feature_172']\n\nStep 3: Evaluating 271 features\n  Mean CV Accuracy: 0.6435 (+/- 0.0139)\n  *** New best score! ***\n  Removing 27 least important features: ['feature_189', 'feature_66', 'feature_44', 'feature_62', 'feature_203', 'feature_262', 'feature_8', 'feature_268', 'feature_121', 'feature_104', 'feature_283', 'feature_176', 'feature_180', 'feature_51', 'feature_120', 'feature_179', 'feature_168', 'feature_267', 'feature_142', 'feature_50', 'feature_237', 'feature_23', 'feature_153', 'feature_186', 'feature_325', 'feature_324', 'feature_72']\n\nStep 4: Evaluating 244 features\n  Mean CV Accuracy: 0.6404 (+/- 0.0116)\n  Removing 24 least important features: ['feature_271', 'feature_307', 'feature_219', 'feature_38', 'feature_167', 'feature_96', 'feature_61', 'feature_39', 'feature_76', 'feature_42', 'feature_71', 'feature_160', 'feature_242', 'feature_304', 'feature_230', 'feature_322', 'feature_144', 'feature_277', 'feature_48', 'feature_156', 'feature_128', 'feature_119', 'feature_152', 'feature_84']\n\nStep 5: Evaluating 220 features\n  Mean CV Accuracy: 0.6422 (+/- 0.0112)\n  Removing 22 least important features: ['feature_134', 'feature_79', 'feature_161', 'feature_129', 'feature_293', 'feature_250', 'feature_154', 'feature_294', 'feature_309', 'feature_68', 'feature_139', 'feature_148', 'feature_114', 'feature_320', 'feature_297', 'feature_115', 'feature_247', 'feature_310', 'feature_15', 'feature_315', 'feature_78', 'feature_226']\n\nStep 6: Evaluating 198 features\n  Mean CV Accuracy: 0.6439 (+/- 0.0112)\n  *** New best score! ***\n  Removing 19 least important features: ['feature_236', 'feature_65', 'feature_292', 'feature_102', 'feature_123', 'feature_330', 'feature_19', 'feature_312', 'feature_258', 'feature_246', 'feature_165', 'feature_131', 'feature_218', 'feature_43', 'feature_69', 'feature_265', 'feature_288', 'feature_323', 'feature_40']\n\nStep 7: Evaluating 179 features\n  Mean CV Accuracy: 0.6398 (+/- 0.0113)\n  Removing 17 least important features: ['feature_105', 'feature_86', 'feature_311', 'feature_137', 'feature_185', 'feature_97', 'feature_314', 'feature_162', 'feature_173', 'feature_108', 'feature_261', 'feature_192', 'feature_285', 'feature_299', 'feature_98', 'feature_74', 'feature_212']\n\nStep 8: Evaluating 162 features\n  Mean CV Accuracy: 0.6423 (+/- 0.0090)\n  Removing 16 least important features: ['feature_166', 'feature_232', 'feature_99', 'feature_198', 'feature_209', 'feature_143', 'feature_140', 'feature_210', 'feature_83', 'feature_284', 'feature_135', 'feature_280', 'feature_287', 'feature_25', 'feature_0', 'feature_249']\n\nStep 9: Evaluating 146 features\n  Mean CV Accuracy: 0.6441 (+/- 0.0074)\n  *** New best score! ***\n  Removing 14 least important features: ['feature_259', 'feature_90', 'feature_113', 'feature_216', 'feature_117', 'feature_169', 'feature_234', 'feature_32', 'feature_245', 'feature_29', 'feature_55', 'feature_184', 'feature_253', 'feature_45']\n\nStep 10: Evaluating 132 features\n  Mean CV Accuracy: 0.6445 (+/- 0.0055)\n  *** New best score! ***\n  Removing 13 least important features: ['feature_251', 'feature_158', 'feature_151', 'feature_88', 'feature_33', 'feature_85', 'feature_308', 'feature_222', 'feature_77', 'feature_254', 'feature_149', 'feature_116', 'feature_298']\n\nStep 11: Evaluating 119 features\n  Mean CV Accuracy: 0.6412 (+/- 0.0143)\n  Removing 11 least important features: ['feature_278', 'feature_75', 'feature_257', 'feature_252', 'feature_122', 'feature_187', 'feature_164', 'feature_110', 'feature_80', 'feature_317', 'feature_281']\n\nStep 12: Evaluating 108 features\n  Mean CV Accuracy: 0.6443 (+/- 0.0093)\n  Removing 10 least important features: ['feature_318', 'feature_215', 'feature_255', 'feature_269', 'feature_316', 'feature_170', 'feature_155', 'feature_301', 'feature_204', 'feature_91']\n\nStep 13: Evaluating 98 features\n  Mean CV Accuracy: 0.6456 (+/- 0.0102)\n  *** New best score! ***\n  Removing 9 least important features: ['feature_146', 'feature_195', 'feature_93', 'feature_289', 'feature_217', 'feature_286', 'feature_73', 'feature_239', 'feature_319']\n\nStep 14: Evaluating 89 features\n  Mean CV Accuracy: 0.6439 (+/- 0.0106)\n  Removing 8 least important features: ['feature_94', 'feature_112', 'feature_147', 'feature_54', 'feature_163', 'feature_263', 'feature_240', 'feature_233']\n\nStep 15: Evaluating 81 features\n  Mean CV Accuracy: 0.6437 (+/- 0.0086)\n  Removing 8 least important features: ['feature_100', 'feature_223', 'feature_266', 'feature_302', 'feature_300', 'feature_270', 'feature_118', 'feature_34']\n\nStep 16: Evaluating 73 features\n  Mean CV Accuracy: 0.6448 (+/- 0.0097)\n  Removing 7 least important features: ['feature_279', 'feature_124', 'feature_16', 'feature_321', 'feature_103', 'feature_201', 'feature_229']\n\nStep 17: Evaluating 66 features\n  Mean CV Accuracy: 0.6419 (+/- 0.0096)\n  Removing 6 least important features: ['feature_238', 'feature_273', 'feature_303', 'feature_150', 'feature_213', 'feature_63']\n\nStep 18: Evaluating 60 features\n  Mean CV Accuracy: 0.6409 (+/- 0.0107)\n  Removing 6 least important features: ['feature_57', 'feature_331', 'feature_82', 'feature_276', 'feature_305', 'feature_109']\n\nStep 19: Evaluating 54 features\n  Mean CV Accuracy: 0.6461 (+/- 0.0095)\n  *** New best score! ***\n  Removing 5 least important features: ['feature_111', 'feature_106', 'feature_64', 'feature_224', 'feature_130']\n\nStep 20: Evaluating 49 features\n  Mean CV Accuracy: 0.6402 (+/- 0.0130)\n  Removing 4 least important features: ['feature_181', 'feature_199', 'feature_81', 'feature_313']\n\nStep 21: Evaluating 45 features\n  Mean CV Accuracy: 0.6465 (+/- 0.0093)\n  *** New best score! ***\n  Removing 4 least important features: ['feature_274', 'feature_326', 'feature_35', 'feature_248']\n\nStep 22: Evaluating 41 features\n  Mean CV Accuracy: 0.6444 (+/- 0.0102)\n  Removing 4 least important features: ['feature_89', 'feature_87', 'feature_10', 'feature_28']\n\nStep 23: Evaluating 37 features\n  Mean CV Accuracy: 0.6487 (+/- 0.0139)\n  *** New best score! ***\n  Removing 3 least important features: ['feature_191', 'feature_141', 'feature_306']\n\nStep 24: Evaluating 34 features\n  Mean CV Accuracy: 0.6430 (+/- 0.0087)\n  Removing 3 least important features: ['feature_107', 'feature_272', 'feature_60']\n\nStep 25: Evaluating 31 features\n  Mean CV Accuracy: 0.6458 (+/- 0.0096)\n  Removing 3 least important features: ['feature_190', 'feature_47', 'feature_205']\n\nStep 26: Evaluating 28 features\n  Mean CV Accuracy: 0.6450 (+/- 0.0142)\n  Removing 2 least important features: ['feature_157', 'feature_329']\n\nStep 27: Evaluating 26 features\n  Mean CV Accuracy: 0.6481 (+/- 0.0090)\n  Removing 2 least important features: ['feature_243', 'feature_5']\n\nStep 28: Evaluating 24 features\n  Mean CV Accuracy: 0.6452 (+/- 0.0086)\n  Removing 2 least important features: ['feature_171', 'feature_235']\n\nStep 29: Evaluating 22 features\n  Mean CV Accuracy: 0.6440 (+/- 0.0096)\n  Removing 2 least important features: ['feature_145', 'feature_275']\n\nStep 30: Evaluating 20 features\n  Mean CV Accuracy: 0.6444 (+/- 0.0077)\n  Removing 2 least important features: ['feature_256', 'feature_136']\n\nStep 31: Evaluating 18 features\n  Mean CV Accuracy: 0.6426 (+/- 0.0051)\n  Removing 1 least important features: ['feature_125']\n\nStep 32: Evaluating 17 features\n  Mean CV Accuracy: 0.6477 (+/- 0.0056)\n  Removing 1 least important features: ['feature_58']\n\nStep 33: Evaluating 16 features\n  Mean CV Accuracy: 0.6406 (+/- 0.0085)\n  Removing 1 least important features: ['feature_328']\n\nStep 34: Evaluating 15 features\n  Mean CV Accuracy: 0.6422 (+/- 0.0074)\n  Removing 1 least important features: ['feature_95']\n\nStep 35: Evaluating 14 features\n  Mean CV Accuracy: 0.6432 (+/- 0.0081)\n  Removing 1 least important features: ['feature_126']\n\nStep 36: Evaluating 13 features\n  Mean CV Accuracy: 0.6417 (+/- 0.0101)\n  Removing 1 least important features: ['feature_264']\n\nStep 37: Evaluating 12 features\n  Mean CV Accuracy: 0.6430 (+/- 0.0090)\n  Removing 1 least important features: ['feature_225']\n\nStep 38: Evaluating 11 features\n  Mean CV Accuracy: 0.6397 (+/- 0.0084)\n  Removing 1 least important features: ['feature_11']\n\nStep 39: Evaluating 10 features\n  Mean CV Accuracy: 0.6395 (+/- 0.0049)\n  Removing 1 least important features: ['feature_174']\n\nStep 40: Evaluating 9 features\n  Mean CV Accuracy: 0.6419 (+/- 0.0099)\n  Removing 1 least important features: ['feature_127']\n\nStep 41: Evaluating 8 features\n  Mean CV Accuracy: 0.6360 (+/- 0.0091)\n  Removing 1 least important features: ['feature_59']\n\nStep 42: Evaluating 7 features\n  Mean CV Accuracy: 0.6412 (+/- 0.0119)\n  Removing 1 least important features: ['feature_159']\n\nStep 43: Evaluating 6 features\n  Mean CV Accuracy: 0.6386 (+/- 0.0138)\n  Removing 1 least important features: ['feature_260']\n\nStep 44: Evaluating 5 features\n  Mean CV Accuracy: 0.6420 (+/- 0.0095)\n  Removing 1 least important features: ['feature_4']\n\nStep 45: Evaluating 4 features\n  Mean CV Accuracy: 0.6428 (+/- 0.0095)\n  Removing 1 least important features: ['feature_244']\n\nStep 46: Evaluating 3 features\n  Mean CV Accuracy: 0.6403 (+/- 0.0066)\n  Removing 1 least important features: ['feature_282']\n\nStep 47: Evaluating 2 features\n  Mean CV Accuracy: 0.6417 (+/- 0.0091)\n  Removing 1 least important features: ['feature_333']\n\nFinal step: 1 feature remaining\n  Mean CV Accuracy: 0.6257 (+/- 0.0066)\n\n================================================================================\nFeature selection complete!\nBest score: 0.6487\nBest number of features: 37\nBest features: ['feature_4', 'feature_5', 'feature_11', 'feature_47', 'feature_58', 'feature_59', 'feature_60', 'feature_95', 'feature_107', 'feature_125', 'feature_126', 'feature_127', 'feature_136', 'feature_141', 'feature_145', 'feature_157', 'feature_159', 'feature_171', 'feature_174', 'feature_190', 'feature_191', 'feature_205', 'feature_225', 'feature_235', 'feature_243', 'feature_244', 'feature_256', 'feature_260', 'feature_264', 'feature_272', 'feature_275', 'feature_282', 'feature_306', 'feature_328', 'feature_329', 'feature_332', 'feature_333']\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "wROE",
      "code_hash": "727de6cfa298556d0ce1b07c8448b975",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "vLEx",
      "code_hash": "afaddf725455d7a3c5bbe1194bb3510b",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    }
  ]
}